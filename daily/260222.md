# 2026.02.22

## 📌 Next.js 서버 vs 백엔드 API 서버

### 개념 정리
- **Next.js 서버**: 프론트엔드를 위한 서버 (Node.js 기반)
- **백엔드 API 서버**: 실제 데이터와 비즈니스 로직을 처리하는 서버
- **둘은 서로 다른 독립적인 서버이며 HTTP로 통신**

### 아키텍처
```
브라우저 
  ↓
Next.js 서버 (포트 3000)
  - SSR/SSG
  - 페이지 렌더링
  - API Routes (선택적)
  ↓
백엔드 API 서버 (포트 8000)
  - 데이터베이스 연결
  - 비즈니스 로직
  - 인증/인가
```

### 주요 차이점

| 특징 | Next.js 서버 | 백엔드 API 서버 |
|------|-------------|----------------|
| **역할** | 페이지 렌더링 | 데이터 & 비즈니스 로직 |
| **언어** | JavaScript/TypeScript | Java, Python, Go 등 |
| **데이터베이스** | 직접 연결 권장 X | 직접 연결 (주 역할) |
| **보안** | 클라이언트 노출 가능 | 민감한 데이터 보관 |

---

## 🔄 React Query & SWR

### 무엇인가?
서버 상태(Server State)를 관리하는 데이터 페칭 라이브러리
- API 호출과 결과를 자동으로 관리
- 복잡한 상태 관리 코드를 간단하게 만들어줌

### 주요 기능
1. **캐싱**: 한 번 불러온 데이터를 저장해서 재사용
2. **자동 재검증**: 데이터가 오래되면 자동으로 다시 불러옴
3. **중복 제거**: 같은 요청은 한 번만 호출
4. **백그라운드 업데이트**: 이전 데이터 보여주며 뒤에서 새 데이터 가져옴
5. **에러 재시도**: 실패 시 자동 재시도
6. **상태 관리 자동화**: 로딩/에러 상태 자동 처리

### 재검증(Revalidation)이란?
이미 가져온 데이터가 유효한지 확인하고, 필요하면 새로 가져오는 것

**재검증 발생 시점:**
- Window Focus: 브라우저 탭으로 다시 돌아올 때
- Network Reconnect: 인터넷 재연결될 때
- Interval: 주기적으로 (설정한 시간마다)
- Manual: 수동 호출 (새로고침 버튼 등)

### 핵심 개념

#### Stale vs Fresh
```typescript
// staleTime: 5초
// Fresh (신선): 5초 이내 → 캐시 사용, API 호출 안 함
// Stale (오래됨): 5초 경과 → 백그라운드에서 새 데이터 가져옴
```

#### 기본 사용법
```typescript
// React Query
const { data, isLoading, error } = useQuery({
  queryKey: ['user'],
  queryFn: fetchUser,
  staleTime: 30000, // 30초
  refetchInterval: 60000, // 60초마다 자동 갱신
});

// SWR
const { data, error, isLoading } = useSWR('/api/user', fetcher, {
  revalidateOnFocus: true,
  refreshInterval: 10000,
});
```

### React Query vs SWR

| 특징 | React Query | SWR |
|------|-------------|-----|
| **개발사** | TanStack | Vercel |
| **번들 크기** | 약간 큼 | 가벼움 |
| **기능** | 매우 풍부 | 심플, 직관적 |
| **DevTools** | 강력한 DevTools | 기본 도구 |
| **추천** | 복잡한 앱 | 간단~중간 앱 |

---

## 💡 정리
- **Next.js 서버 ≠ 백엔드 API 서버**: 독립적인 두 서버가 HTTP로 통신
- **React Query/SWR**: API 호출 자동화로 개발자 경험 향상
- **재검증**: 데이터를 항상 최신으로 유지하는 메커니즘

